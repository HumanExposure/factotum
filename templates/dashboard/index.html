{% extends 'core/base.html' %}
{% load staticfiles %}
{% load humanize %}

{% block content %}
    <h1><span class="oi oi-wrench" title="factotum" aria-hidden="true"></span>
        Welcome to Factotum</h1>
    <br>

    <div class="card-deck">
      <div class="card text-center bg-light">
          <div class="card-body">
            <h3 class="card-title text-muted">Sources</h3>
            <div class="card-text font-weight-bold display-4">{{ source_count | intword}} </div>
          </div>
      </div>
      <div class="card text-center bg-light">
          <div class="card-body">
            <h3 class="card-title text-muted">Groups</h3>
            <div class="card-text font-weight-bold display-4">{{ group_count | intword}} </div>
          </div>
      </div>
      <div class="card text-center bg-light">
          <div class="card-body">
              <h3 class="card-title text-muted">Documents</h3>
              <div class="card-text font-weight-bold display-4">{{ document_count | intword}} </div>
          </div>

      </div>
    </div>

    <p></p>
    <h4>Documents Uploaded</h4>
    <div id="lineChart">
        <svg style="height:350px;width:50%;overflow:visible"></svg>
    </div>
{% endblock %}

{% block css %}
    <!-- NVD3 CSS -->
    <link rel="stylesheet" href="{% static "css/nv.d3.css" %}">
{% endblock %}

{% block js %}
    <script src="{% static 'js/d3.js' %}"></script>
    <script src="{% static 'js/nv.d3.js' %}"></script>
    <script src="{% static 'js/dashboard/index.js' %}"></script>
    <script>
        data_lineChart = [
            {
                'color': 'blue',
                'values': [
                    {% for item in document_stats.all %}
                        {
                            'y': {{ item.document_count }},
                            'x': '{{ item.upload_date }}'
                        },
                    {% endfor %}
                ],
                'key': 'All',
                'yAxis': '0'
            },
            {
                'color': 'green',
                'values': [
                    {% for item in document_stats.product %}
                        {
                            'y': {{ item.document_count }},
                            'x': '{{ item.upload_date }}'
                        },
                    {% endfor %}
                ],
                'key': 'Product',
                'yAxis': '0'
            },
            {
                'color': 'red',
                'values': [
                    {% for item in document_stats.msds_sds %}
                        {
                            'y': {{ item.document_count }},
                            'x': '{{ item.upload_date }}'
                        },
                    {% endfor %}
                ],
                'key': 'MSDS/SDS',
                'yAxis': '0'
            }
        ];
    </script>
{% endblock %}
